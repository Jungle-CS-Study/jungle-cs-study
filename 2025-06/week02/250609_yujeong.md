# HTTP란?

HTTP(HyperText Transfer Protocol)는 클라이언트와 서버 사이에 이루어지는 상호 대화를 위한 요청-응답 프로토콜이다.


# 캐싱이란?

자주 사용되는 데이터나 계산 결과를 임시 저장 공간(캐시)에 저장하여 다음 요청에 대한 접근 시간을 줄이는 기술이다.

웹 사이트의 경우, 이미지, JS, css등 정적 자원을 로컬에 저장하여 빠른 페이지 로딩을 가능하게 하고, 애플리케이션의 경우 자주 사용하는 데이터베이스 쿼리 결과를 캐싱하여 성능을 향상시킨다.

### 캐싱의 주요 용어 및 개념

* 캐시(Cache) : 데이터를 임시로 저장하는 **공간**
* 캐싱(Caching) : 데이터를 캐시에 저장하는 행위
* 캐시 서버 : 캐시를 관리하고 요청을 처리하는 서버
* 캐시 만료 : 캐시된 데이터가 일정 기간 후 제거 되는 것
* 캐시 히트 : 요청된 데이터가 캐시에 있는 경우
* 캐시 미스 : 요청된 데이터가 캐시에 없는 경우

# Cache-Control 

HTTP 헤더로, 캐시 동작 방식을 지정한다.

### 주요 디렉티브
* max-age=초 : 응답이 몇 초 동안 유효한지 설정. (예: max-age=3600 → 1시간)

* no-cache : 캐시 가능하지만, 재검증 필요 (If-Modified-Since/If-None-Match로 확인)

* no-store : 캐시에 저장하지 말라는 뜻.

* public : 모든 캐시가 응답을 저장 가능.

* private : 사용자 개인 캐시만 저장 가능.

* must-revalidate : 캐시된 응답이 만료되면 반드시 서버 **재검증**

캐시의 유효기간이 지나기 전이라면, 브라우저는 서버에 요청을 보내지 않고, 디스크 또는 메모리에서만 캐시를 읽어와 계속 사용한다.

## 캐시의 유효 기간이 지난 이후 : 재검증

캐시의 유효 기간이 지나면 캐시가 완전히 사라지게 될까? 그렇지 않다.
대신 브라우저는 서버에 **조건부 요청**을 통해 캐시가 유효한지 재검증을 수행한다.

* 조건부 요청 : 특정 조건이 만족할 때만 서버가 리소스를 내려주거나 처리하도록 하는 HTTP 요청    

일반적인 요청은 클라이언트가 서버에 단순히 "이 리소스 줘!" 라고 요청하지만, 조건부 요청은, "내가 가지고 있는 리소스가 최신이면 굳이 다시 안 받아도 되니까, 최신이 아니면 보내줘!" 라고 조건을 거는 것   

## 재검증 방식

### 1. If-Modified-Since
1. 서버가 응답할 때, Last-Modified 헤더를 보냈다면, 클라이언트가 브라우저의 요청에 대한 로컬 캐시의 max-age의 만료를 확인한다.

```
Last-Modified: Mon, 08 Jun 2025 09:00:00 GMT
```   

그리고 If-Modified-Since 검증 헤더를 추가해서 HTTP 요청을 보낸다.   

```
If-Modified-Since: Mon, 08 Jun 2025 09:00:00 GMT
```

2. 서버는 HTTP 요청에 있는 검증 헤더 If-Modified-Since 를 통해 기존 요청의 응답으로 받은 데이터가 변경되었는지 확인한다.

3. 데이터가 미변경 되었다면, 304 Not Modified로 HTTP 응답을 하고, 
변경되었다면 새 리소스와 함께 200 OK 응답을 한다.

* 304 Not Modified 응답은 HTTP 본문을 포함하지 않기 때문에 매우 빠르게 내려받을 수 있다.

### 2. If-None-Match

서버가 응답할 때 ETag 를 보냈다면,

```
ETag: "abc123"
```    

클라이언트는 다음 요청 시 HTTP 요청 헤더에 담아서 요청 데이터가 최신인지 아닌지를 검증한다.

```
If-None-Match: "abc123"
```   

만약 데이터의 변경이 없어서 요청한 ETag의 값과 현재 데이터의 ETage의 값이 동일하면 HTTP 응답코드로 304 Not Modified를 반환받는다.


* ETag HTTP 응답 헤더는 클라이언트가 이전에 요청했던 데이터와 최신 데이터의 변경사항 유무를 검증하는 데 사용하는 HTTP 응답 헤더이다. 클라이언트에서 최신 데이터 자료를 요청할 때(HTTP Get 요청) 응답 헤더로 ETag 값이 반환된다. ETag의 값은 일반적으로 MD5 등의 hash 함수를 이용하여 생성된 값인 Message Digest를 사용한다.

