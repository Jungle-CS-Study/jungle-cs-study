# HTTP와 HTTPS의 구조적 이해 – 프로토콜, 보안, 계층 분석

---

## 1. HTTP의 OSI 7계층 내 위치

| OSI 계층       | 주요 역할                        | 관련 프로토콜         |
| ------------ | ---------------------------- | --------------- |
| 7. 애플리케이션 계층 | 사용자와 가장 가까운 계층, 요청/응답 메시지 처리 | HTTP, FTP, SMTP |
| 6. 표현 계층     | 인코딩, 암호화, 압축 등               |                 |
| 5. 세션 계층     | 세션 유지 및 관리                   |                 |
| 4. 전송 계층     | 신뢰성 있는 데이터 전송, 흐름 제어, 오류 복구  | TCP             |
| 3. 네트워크 계층   | IP 주소 기반 라우팅                 | IP              |
| 2. 데이터 링크 계층 | MAC 주소 기반 전송                 |                 |
| 1. 물리 계층     | 실제 전기/광 신호 전송                |                 |

HTTP는 애플리케이션 계층에 위치하며, 실제 데이터 전송은 하위 계층인 TCP/IP에서 처리한다.

---

## 2. HTTP는 '형식 규약'이다

HTTP는 "데이터를 어떻게 전송하라"가 아닌 "어떻게 구성하라"는 통신 형식 규약(protocol rule set)이다.

* 요청(Request)과 응답(Response) 메시지의 형식, 헤더 구조, 메서드(GET, POST 등)를 정의

### 메시지 예시

```
GET /hello HTTP/1.1
Host: www.example.com

HTTP/1.1 200 OK
Content-Type: text/html

<html>...</html>
```

전송은 TCP가, 형식은 HTTP가 담당한다.

---

## 3. TCP의 역할과 한계

### TCP가 제공하는 기능

* 연결 지향(3-way handshake)
* 패킷 순서 보장
* 손실 시 재전송
* 흐름 제어 / 혼잡 제어

### TCP의 보안 한계

* 암호화 없음
* 상대방 인증 없음
* 데이터 위변조 방지 없음

HTTP는 TCP 위에서 동작하지만, 보안성이 전혀 없다.

---

## 4. HTTP 통신의 보안 문제

| 위험 | 설명                        |
| -- | ------------------------- |
| 도청 | 요청/응답 내용이 외부에 그대로 노출됨     |
| 변조 | 전송 중 데이터가 변경될 수 있음        |
| 위조 | 공격자가 서버 또는 클라이언트를 가장하여 응답 |
| 피싱 | 신뢰되지 않은 서버로 접속 유도         |

---

## 5. TLS(SSL)의 도입 – HTTPS의 시작

### TLS (Transport Layer Security)

* TCP와 HTTP 사이에 존재하는 암호화 계층
* HTTPS = HTTP + TLS
* TLS는 통신을 암호화하고 인증과 무결성을 제공

### TLS 제공 보안 요소

| 요소  | 설명                     |
| --- | ---------------------- |
| 기밀성 | 대칭키 암호화로 내용 보호         |
| 무결성 | MAC으로 메시지 위변조 방지       |
| 인증  | 인증서를 통한 서버/클라이언트 신뢰 확보 |

---

## 6. TLS 통신 흐름 (핸드쉐이크 절차)

### TLS Handshake 흐름 (RSA 방식 기준)

1. Client Hello: 클라이언트가 암호 알고리즘 목록, 난수 전송
2. Server Hello + 인증서: 서버가 공개키 포함 인증서 전송
3. 키 교환: 클라이언트가 세션 키를 공개키로 암호화해 전송
4. 서버는 개인키로 복호화, 양측 세션키 공유 완료
5. 이후 HTTP 메시지를 세션키로 암호화하여 전송

---

## 7. HTTPS 구조: TCP + TLS + HTTP

```
[Application]     HTTP       ← 요청/응답 메시지 정의
[Security]        TLS        ← 암호화, 인증, 무결성
[Transport]       TCP        ← 신뢰성 있는 전송
[Network]         IP         ← 라우팅, 패킷 전달
```

HTTP는 변경되지 않고, TLS 계층이 보안 기능을 제공한다.

---

## 8. 인증서 체계(PKI)

HTTPS는 공개키 기반 구조(PKI)를 사용하여 인증서를 통해 신뢰를 전파한다.

### 인증서 구성

* 도메인 이름
* 공개키
* 유효 기간
* CA 서명

### 인증서 신뢰 체계

```
Root CA → Intermediate CA → 서버 인증서
```

브라우저는 Root CA 목록을 내장하고 있으며, 체인을 따라 신뢰를 검증한다.

---

## 9. HTTP/2, HTTP/3의 보안 변화

### HTTP/2

* 멀티플렉싱, 헤더 압축 등 성능 개선
* HTTPS를 사실상 필수로 사용

### HTTP/3

* TCP 대신 QUIC 사용 (UDP 기반)
* TLS 1.3 내장
* 초기부터 암호화 전제를 두고 설계됨

---

## 최종 요약

| 항목       | 설명                         |
| -------- | -------------------------- |
| HTTP 위치  | OSI 7계층 애플리케이션 계층          |
| HTTP 정체  | 메시지 형식 정의하는 규약             |
| 전송 담당    | TCP (신뢰성 제공, 보안은 없음)       |
| HTTP 보안  | 없음 (평문 통신)                 |
| HTTPS 구성 | HTTP + TLS + TCP           |
| TLS 역할   | 암호화, 무결성, 인증 제공            |
| 인증서 체계   | PKI 기반, 브라우저 내 Root CA로 검증 |
| HTTP/3   | TLS 1.3 내장, 암호화가 기본        |

---
